# function - add_g_test
# Adds gtest-based unit-test to the build
# param_0 - name of the test. Should be the same, as the name of the *.cpp file, which implements the test
# param_1 ... param_n - libraries, which should be linked to a test
function(add_g_test)
    if (DEFINED ARGV0)
        add_executable(${ARGV0} ${ARGV0}.cpp)
        target_link_libraries(${ARGV0} gtest_main)
        add_test(NAME ${ARGV0} COMMAND ${ARGV0})
        target_include_directories(${ARGV0} PRIVATE ${PROJECT_SOURCE_DIR})
        
        math(EXPR lastIndex "${ARGC}-1")
        foreach(index RANGE 0 ${lastIndex})
            target_link_libraries(${test_name} ${ARGV${index}}) 
        endforeach()
    endif()
endfunction(add_g_test)